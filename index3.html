<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Audio-Visual Global News Portal</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f3f4f6; color: #111827; }
    header { background: #000; color: #fff; padding: 16px; text-align: center; }
    button { border: none; cursor: pointer; border-radius: 6px; }
    .lang-btn { padding: 8px 12px; background: #e5e7eb; margin: 4px; }
    .lang-btn.active { background: #2563eb; color: #fff; }
    .refresh { padding: 8px 12px; background: #10b981; color: #fff; }
    .container { max-width: 1100px; margin: 20px auto; display: grid; grid-template-columns: 2fr 1fr; gap: 16px; padding: 12px; }
    main, aside { background: #fff; border-radius: 12px; padding: 16px; }
    article { border-bottom: 1px solid #e5e7eb; padding-bottom: 12px; margin-bottom: 12px; }
    iframe { width: 100%; height: 250px; border: none; border-radius: 8px; }
  </style>
</head>
<body>
  <header>
    <h1>AI Audio-Visual Global News Portal</h1>
    <p>Live, multilingual, and hourly updated</p>
    <div>
      <button id="enBtn" class="lang-btn active">English</button>
      <button id="hiBtn" class="lang-btn">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
      <button id="taBtn" class="lang-btn">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
      <button id="refreshBtn" class="refresh">üîÑ Refresh</button>
    </div>
  </header>
  <div id="errorBox" style="background:#ef4444;color:#fff;text-align:center;padding:8px;display:none"></div>
  <div class="container">
    <main id="newsContainer"></main>
    <aside>
      <h4>Live Video</h4>
      <iframe id="liveFrame" allowfullscreen></iframe>
      <div id="updatedTime" style="margin-top:12px;text-align:center;color:#6b7280"></div>
    </aside>
  </div>
  <script>
    const newsContainer = document.getElementById('newsContainer');
    const errorBox = document.getElementById('errorBox');
    const updatedTime = document.getElementById('updatedTime');
    const liveFrame = document.getElementById('liveFrame');

    const liveStreams = {
      en: 'https://www.bbc.com/news/av/embed/p08t2g54/53999932',
      hi: 'https://www.tv9hindi.com/live-tv',
      ta: 'https://www.24x7liveindia.com/embed/puthiyathalaimurai'
    };

    let currentLang = 'en';

    function setActiveLang(lang) {
      document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById(lang + 'Btn').classList.add('active');
      currentLang = lang;
      liveFrame.src = liveStreams[lang];
      fetchNews();
    }

    async function fetchNews() {
      errorBox.style.display = 'none';
      newsContainer.innerHTML = '<p>Loading news‚Ä¶</p>';
      try {
        let articles = [];
        if (currentLang === 'en') {
          const res = await fetch('https://api.rss2json.com/v1/api.json?rss_url=' + encodeURIComponent('https://feeds.bbci.co.uk/news/rss.xml'));
          const data = await res.json();
          articles = data.items.slice(0, 10);
        } else {
          const apiKey = 'pub_fefd285deecd4e7cbb8dd38b5923adb1';
          const res = await fetch(`https://newsdata.io/api/1/news?apikey=${apiKey}&language=${currentLang}`);
          const data = await res.json();
          if (data.results) {
            articles = data.results.slice(0, 10);
          }
        }
        renderNews(articles);
        updatedTime.textContent = 'Last updated: ' + new Date().toLocaleTimeString();
      } catch (e) {
        errorBox.textContent = 'Failed to load news';
        errorBox.style.display = 'block';
      }
    }

    function speakNews(title, desc) {
      if (!('speechSynthesis' in window)) return;
      const text = title + '. ' + (desc || '');
      const utter = new SpeechSynthesisUtterance(text);
      if (currentLang === 'hi') utter.lang = 'hi-IN';
      else if (currentLang === 'ta') utter.lang = 'ta-IN';
      else utter.lang = 'en-US';
      speechSynthesis.cancel();
      speechSynthesis.speak(utter);
    }

    function renderNews(articles) {
      newsContainer.innerHTML = '';
      articles.forEach(n => {
        const div = document.createElement('article');
        div.innerHTML = `<h3>${n.title}</h3><p>${n.description || ''}</p><div><button onclick=\"speakNews('${n.title.replace(/'/g, '')}', '${(n.description || '').replace(/'/g, '')}')\">üîä Listen Full</button><a href='${n.link}' target='_blank'> Read More</a></div>`;
        newsContainer.appendChild(div);
      });
    }

    document.getElementById('enBtn').onclick = () => setActiveLang('en');
    document.getElementById('hiBtn').onclick = () => setActiveLang('hi');
    document.getElementById('taBtn').onclick = () => setActiveLang('ta');
    document.getElementById('refreshBtn').onclick = () => fetchNews();

    liveFrame.src = liveStreams.en;
    fetchNews();
  </script>
</body>
</html>
